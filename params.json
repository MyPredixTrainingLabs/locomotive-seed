{
  "name": "Locomotive-seed",
  "tagline": "Updated Dashboard Seed to View locomotive data",
  "body": "#Predix Experience 2.0 Seed\r\nDashboard Seed is an application that uses Px Web Components and <a href=\"https://github.com/PredixDev/px-library-design/\" target=\"_blank\">Px UI Elements</a> inside an Angular application.\r\n\r\n## To Run the Dashboard Seed\r\n\r\n### Get the source code\r\nMake a directory for your project.  Clone or download and extract the seed in that directory.\r\n```\r\ngit clone\r\n```\r\n\r\n### Install the dependencies\r\n```\r\nnpm install\r\nbower install\r\n```\r\n\r\n### Create a dist version\r\nUse grunt to create a distribution version of your app, which will be located in the dist folder along with the nginx configuration files.  You will need to run this command during development every time before you cf push to make the latest dist.\r\n```\r\ngrunt dist\r\n```\r\n\r\n## Setup services for your own development\r\nOnce you're ready to actually start developing, you'll need to setup your own UAA and Views service.\r\n\r\n### UAA\r\n1. Create a UAA instance following [these steps](https://www.predix.io/docs/?r=250183#XpKGAdQ7-Q0CoIStl).\r\n\t* Note: Make a note of the client secret; you will need it later.\r\n2. Get the url of that UAA instance\r\n\t1. Locate any application you have running on cloud foundry.  If you don't have one, you'll have to push some app up there.\r\n\t2. Follow [these steps](https://www.predix.io/docs/?r=250183#sXp7cw5P-Q0CoIStl) to bind your dummy app to UAA.\r\n\t3. Save the uri and issuerId of your UAA instance.\r\n\r\n### Views\r\nCreate a Views instance following [these steps](https://www.predix.io/docs/?r=250183#yyKdebUl).  Use the UAA issuerId that you gathered above for your trusted issuer.\r\n* Note: You must use underscores in your service instance name currently (my_view_service, NOT my-view-service)\r\n\r\n### Redis\r\nCreate a Redis instance, which is used by nginx for storing your session.\r\n```\r\ncf cs redis <plan> <instance_name>\r\n``` \r\n\r\n## Push to the cloud\r\nNow that you have the required services created, we can push to the cloud for the first time.\r\n\r\n1. Update manifest.yml\r\n\t\r\n\tYou'll need to change these fields in your manifest.yml before pushing to the cloud.\r\n\t```\r\n\t  - name: my-predix-seed # change this to your application name\r\n\t    services:\r\n\t            - your_redis_instance # change this to your redis service instance name\r\n\t            - your_view_service_instance # change this to your view service instance name\r\n\t    env:\r\n\t      UAA_SERVER_URL: https://your-uaa-instance.grc-apps.svc.ice.ge.com # change to your UAA instance url\r\n\t      REDIS: redis # change this to the name of the Redis service in your marketplace (when you do cf m).  It may be redis, or something else\r\n\t```\r\n2. Update View service reference in nginx.conf\r\n\r\n\tYou need to update nginx.conf (in the dist folder) wherever it has references to predix_seed_view_service to the name of your_view_service_instance, which is whatever you specified in step 1.\r\n\r\n\t```\r\n\t# for example, from\r\n\tproxy_set_header    predix-zone-id   \"<%= ENV[\"vcap_service_predix_seed_view_service_instanceId\"] %>\";\r\n\tproxy_pass  \"<%= ENV[\"vcap_service_predix_seed_view_service_uri\"] %>\";\r\n\t\r\n\t# to (assuming you changed your_view_service_instance to my_special_views_service in your manifest.yml)\r\n\tproxy_set_header    predix-zone-id   \"<%= ENV[\"vcap_service_my_special_views_service_instanceId\"] %>\";\r\n\tproxy_pass  \"<%= ENV[\"vcap_service_my_special_views_service_uri\"] %>\";\r\n\t```\r\n\r\n3. Make a unique session_secret and set it in nginx.conf.\r\n\t\r\n\t```\r\n\t# example, for Mac\r\n\topenssl rand -base64 32\r\n\t```\r\n\t```\r\n\tset $session_secret <my-session-secret>;\r\n\t```\r\n4. Push to the cloud. \r\n\r\n\t```\r\n\tcf push\r\n\t```\r\n\t\r\n    If your app is started successfully, go to the url that is printed out. You should see your app running, and it will redirect to a page with a message __\"Uh oh. Something went amiss\"__.  \r\n    \r\n    * Note: This is just the first time pushing your application to cloudfoundry. You will need to push a few more times before completing the setup. \r\n    \r\n## Get Views service url and instance id\r\nThe cf env command for your app will provide you the details of the services your app is bound to.\r\n```\r\ncf env <your-app>\r\n```\r\nIn VCAP_SERVICES, look for the \"predix-views\" section.  Write down the instanceId and uri.\r\n\r\n## Set up UAA client\r\nYou are not able to see the login page because you have a fresh UAA instance which is not setup with an OAuth2 client.\r\n\r\n1. Target your UAA and Log in as Admin\r\nFollow [these steps](https://www.predix.io/docs/?r=913171#JA5oCs7).  You will need the UAA uri and client secret that you saved previously.\r\n\r\n2. Create OAuth2 client\r\n\t\r\n\tFirst, you will need to generate a client secret and save it for later.\r\n\t```\r\n\t# example, for Mac\r\n\topenssl rand -base64 32\r\n\t```\r\n\tNext, we will continue using uaac to add a client for your application.  Use the interactive mode (-i) to add your client.\r\n\t```\r\n\tuaac client add <your-client> -i\r\n\t```\r\n\tAt the prompts, specify:\r\n\t* client secret: the secret that you generated above\r\n\t* scope: openid scim.me\r\n\t* authorized grant types: refresh_token authorization_code\r\n\t* authorities: openid scim.me uaa.resource\r\n\t* autoapprove: openid scim.me\r\n\t* just hit return for any other options\r\n\r\n\tSee [the documentation](https://www.predix.io/docs/?r=913171#uAyBrT9y) for more detailed information about creating clients and the UAA options.\r\n\r\n3. Update nginx.conf with your client\r\n\r\n\tChange the $client_id in nginx.conf to the client name you just created.\r\n\t```\r\n\tset $client_id <your-client>;\r\n\t```\r\n\tGenerate the UAA authorization header for your client by base64 encoding your client and client's secret.\r\n\t```\r\n\tbase64 encode the following string: \"<client-name>:<client secret>\"\r\n\t```\r\n\tFinally, set the $uaa_authorization_header to Basic authentication with this header.\r\n\t```\r\n\tset $uaa_authorization_header  \"Basic <your-auth-header>\";\r\n\t```\r\n4. cf push\r\n\r\n\tIf you cf push again, you should now be successfully redirected to a login page, but you don't have anyone to log in as.\r\n\r\n## Update grunt for local development\r\n\r\nNode and grunt are great for development, but we will have to configure them separately.\r\n\r\nAll the settings you will need to touch are at the top of tasks/options/connect.js.\r\n\r\n1. UAA\r\n\r\n\tUpdate the uaa object with:\r\n\t* clientId - your client\r\n\t* serverUrl - your UAA instance url (like https://my.uaa.instance.predix.io)\r\n\t* base64ClientCredential - the authorization header you used above ```(base64(<client-name>:<client secret>))```\r\n\t\t* do NOT include \"Basic \", just the base 64 string\r\n\r\n\t```\r\n\tuaa: {\r\n\t    clientId: '<your-client>', \r\n\t    serverUrl: '<your-server-url>', \r\n\t    defaultClientRoute: '/about',\r\n\t    base64ClientCredential: '<your-client-credential>'\r\n\t},\r\n\t```\r\n\r\n2. Views\r\n\r\n\tUpdate the view-service proxy object with:\r\n\t* url - your view service url, with /api$1 at the end of it (like http://my-view-service.predix.io/api$1)\r\n\t* instanceId - your view service instance id\r\n\r\n\t```\r\n\tproxy: {\r\n\t'/api/view-service(.*)': {\r\n\t  url: '<your-view-service-url>/api$1',\r\n\t  instanceId: '<your-view-service-instance>'\r\n\t}\r\n```\r\n\r\n## Set up authorized user\r\nNow that you can see the login page, let's set up a user that we can log in with.\r\n\r\n1. Add a user\r\n\r\n\tAdd a user to your UAA instance by providing a user name, email address, and password.\r\n\t```\r\n\tuaac user add rocket --emails rocket@example.com -p Gu@rdian5\r\n\t```\r\n\r\n2. cf push\r\n\r\n\tNow when you cf push, you should be able to login as the user you set up above.  After you login, you should be redirected back to the seed application where you can see the blank page and dashboard.  But, when you select a context, you don't have any views displayed.\r\n\r\n\r\n## Add views to your Views service instance\r\nTo add views and cards to your Views service, you can use the tool of your choice (for example, Postman) to hit your Views service endpoint with the proper headers.\r\n\r\n### Make sure the Views service is up\r\nDo a GET request to your views service url that we just found.\r\n\r\nYou should get a 200 OK response that has a started and uptime, which show that the service is up and running successfully.\r\n\r\n### Give user permission to see views\r\nThe first thing we need to do is give our dummy user permission to see the views, which the following steps walk you through.  For more information on creating groups and scopes, see [the documentation](https://www.predix.io/docs/?r=913171#RulzoBew).\r\n\r\n1. Create a group in your UAA instance for views\r\n\t```\r\n\tuaac group add views.zones.<your-views-instance-id>.user\r\n\r\n\t# example:\r\n\tuaac group add views.zones.1234567890.user\r\n\t```\r\n2. Add the user(s) you created earlier to this group\r\n\t```\r\n\tuaac member add views.zones.<your-views-instance-id>.user <your-user>\r\n\r\n\t# example:\r\n\tuaac member add views.zones.1234567890.user rocket\r\n\t```\r\n3. Update your client scope to include this group\r\n\r\n\tUse uaac to get your current client scope, and add the group you just created to this list.\r\n\t```\r\n\tuaac client get <your-client> \r\n\tuaac client update <your-client> --scope views.zones.<your-views-instance-id>.user,<other>,<scopes>\r\n\r\n\t# example:\r\n\tuaac client update my-client --scope openid,views.zones.123456790.user,scim.me\r\n\t```\r\n4. Update your client autoapprove to include this group\r\n\r\n\tUse uaac to get your current client autoapprove, and add the group you just created to this list.\r\n\t```\r\n\tuaac client get <your-client> \r\n\tuaac client update <your-client> --autoapprove views.zones.<your-views-instance-id>.user,<other>,<autoapproves>\r\n\r\n\t# example:\r\n\tuaac client update <your-client> --autoapprove openid,scim.me,views.zones.<your-views-instance-id>.user\r\n\t```\r\n\r\n### Understanding the headers\r\n\r\nDo a GET request to /api/decks, with no headers specified.\r\n```\r\n<your-views-service-url>/api/decks\r\nexample: https://my-views-service.predix.io/api/decks\r\n```\r\n\r\nYou should get a 500 response because you are missing two mandatory headers.\r\n\r\n1. predix-zone-id header\r\n\r\n\tThe predix-zone-id header is used for multi-tenancy; it specifies which views service instance is yours.\r\n\r\n\tSet the predix-zone-id header to your Views instance id that you pulled earlier from VCAP_SERVICES.\r\n\t\r\n\t```\r\n\tpredix-zone-id : <your-views-instance-id>\r\n\t```\r\n\r\n2. Authorization header\r\n\r\n\tThe Authorization header requires a JWT token which includes information about the user and their roles.\r\n\r\n\tTo get the JWT token, you will need to log in locally through your application.\r\n\t* Run your app and go to localhost:9000 in your browser\r\n\t* Sign in\r\n\t* In the terminal that you ran your app from, you will see the token printed out (this only happens in development mode).\r\n\t* Copy this token\r\n\r\n\tSet the Authorization header to your token.\r\n\t```\r\n\tAuthorization : bearer <your-token>\r\n\t```\r\n\r\nRepeat the request to /api/decks with both headers.  You should (finally) get back an empty array of data!\r\n\r\n### Add the dummy data to your views service\r\nWe will just quickly tell you how to add the dummy data in the demo to your Views service instance.  For more information on the API, see the [documentation](https://www.predix.io/docs/?r=182801#IZkY1Ssd).\r\n\r\nNote: You may also need to set Content-Type header to application/json for the POSTs below.\r\n\r\n#### Add decks\r\nAdd the 3 decks that are in the seed app.\r\n\r\n\tPOST /api/decks \r\n\r\n\t[\r\n\t  {\r\n\t    \"title\": \"Overview\"\r\n\t  },\r\n\t  {\r\n\t    \"title\": \"Detail\"\r\n\t  },\r\n\t  {\r\n\t    \"title\": \"Datagrid View\"\r\n\t  }\r\n\t]\r\n\r\n\r\n#### Add cards\r\nAdd the 4 cards that are in the seed app.\r\n\r\n\tPOST /api/cards \r\n\r\n\t[\r\n\t  {\r\n\t    \"title\": \"datagrid card\",\r\n\t    \"slug\": \"datagrid-card\"\r\n\t  },\r\n\t  {\r\n\t    \"title\": \"widgets card\",\r\n\t    \"slug\": \"widgets-card\"\r\n\t  },\r\n\t  {\r\n\t    \"title\": \"gist card\",\r\n\t    \"slug\": \"gist-card\"\r\n\t  },\r\n\t  {\r\n\t    \"title\": \"time series card\",\r\n\t    \"slug\": \"time-series-card\"\r\n\t  }\r\n\t]\r\n\r\n\r\n#### Put the cards in the decks\r\nAdd the cards to the specified decks.  The ids may be different since the bulk creates are asynchronous, so you may need to change the ids accordingly.\r\n\r\nOverview deck has widgets and gist card (ids may change)\r\n\t\r\n\tPOST /decks/1/cards/add\r\n\t\r\n\t[\"2\", \"3\"]\r\n\t\r\n\r\nDetail deck has time series card (ids may change)\r\n\r\n\tPOST /decks/2/cards/add\r\n\t\r\n\t[\"4\"]\r\n\t\r\n\r\nDatagrid View deck has datagrid card (ids may change)\r\n\r\n\tPOST /decks/3/cards/add\r\n\t\r\n\t[\"1\"]\r\n\t\r\n\r\n\r\n#### Tag the decks\r\nTag the decks with appropriate tags so we can filter which contexts they will be displayed for.  In this simple example, the Parent Asset has the tag parent and the Child Asset has the tag child.\r\n\r\nOverview deck is shown for the parent tag (ids may change)\r\n\r\n\tPOST /api/decks/1/tags\r\n\t\r\n\t[{\"value\":\"parent\"}]\r\n\t\r\n\r\nDetail deck is shown for the child tag (ids may change)\r\n\r\n\tPOST /api/decks/2/tags\r\n\t\r\n\t[{\"value\":\"child\"}]\r\n\t\r\n\r\nDatagrid View deck is shown for the parent tag (ids may change)\r\n\r\n\tPOST /api/decks/3/tags\r\n\t\r\n\t[{\"value\":\"parent\"}]\r\n\t\r\n\r\n### View the final result!\r\ncf push again, and your application should now look just like the demo seed app.\r\n\r\n## Questions?\r\n- Ask questions and file tickets on <a href=\"https://www.predix.io/community\" target=\"_blank\">https://www.predix.io/community</a>.\r\n\r\n# Copyright\r\nCopyright &copy; 2015 GE Global Research. All rights reserved.\r\n\r\nThe copyright to the computer software herein is the property of\r\nGE Global Research. The software may be used and/or copied only\r\nwith the written permission of GE Global Research or in accordance\r\nwith the terms and conditions stipulated in the agreement/contract\r\nunder which the software has been supplied.\r\n\r\n\r\n",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}